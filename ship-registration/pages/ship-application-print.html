<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø³ÙÙŠÙ†Ø© ØªØ¬Ø§Ø±ÙŠØ© - Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ø´Ø¦ÙˆÙ† Ø§Ù„Ø¨Ø­Ø±ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* ØªØµÙ…ÙŠÙ… ÙˆØ±Ø¯ Ø¨Ø³ÙŠØ· - Ø£Ø¨ÙŠØ¶ ÙˆØ£Ø³ÙˆØ¯ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background-color: #e6e9ef;
            font-family: 'Noto Sans Arabic', sans-serif;
            padding: 40px 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .word-template {
            max-width: 900px;
            width: 100%;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 45px 50px;
            border: 1px solid #d0d5dd;
        }
        hr {
            border: none;
            border-top: 2px solid black;
            margin: 15px 0;
        }
        .thin-hr {
            border-top: 1px solid #aaa;
            margin: 10px 0;
        }
        .title-main {
            font-size: 22px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 5px;
        }
        .title-sub {
            font-size: 16px;
            font-weight: 600;
            text-align: center;
            color: #2c3e50;
            margin-bottom: 25px;
        }
        .field-row {
            display: flex;
            align-items: baseline;
            margin-bottom: 18px;
            flex-wrap: wrap;
        }
        .field-label {
            font-weight: 700;
            min-width: 170px;
            font-size: 15px;
            color: #1e1e1e;
        }
        .field-value {
            font-weight: 600;
            color: #0a3144;
            border-bottom: 1px solid #555;
            padding-bottom: 2px;
            padding-right: 10px;
            flex: 1;
            font-size: 15px;
        }
        .section-header {
            font-weight: 700;
            font-size: 18px;
            margin: 35px 0 20px 0;
            border-bottom: 1.5px solid black;
            padding-bottom: 6px;
        }
        .declaration-box {
            margin: 35px 0 25px;
            padding: 15px 0;
            border-top: 1px solid black;
            border-bottom: 1px solid black;
        }
        .declaration-text {
            font-size: 15px;
            line-height: 1.9;
            font-weight: 500;
            margin-bottom: 5px;
        }
        .footer-note {
            margin-top: 40px;
            text-align: center;
            font-size: 12px;
            color: #4a5568;
            border-top: 1px solid #ccc;
            padding-top: 20px;
        }
        @media print {
            body { background: none; padding: 0; }
            .word-template { box-shadow: none; border: none; padding: 40px; }
            .no-print { display: none; }
        }
        .no-print {
            text-align: center;
            margin-top: 30px;
        }
        .btn {
            background: white;
            border: 1px solid #2d6b9e;
            padding: 8px 25px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            border-radius: 4px;
            color: #1a365d;
        }
        .btn:hover {
            background: #ebf4ff;
        }
        .btn-print {
            background: #1e4b7a;
            color: white;
            border: none;
        }
        .btn-print:hover {
            background: #2c5f8a;
        }
        i { margin-left: 5px; }
    </style>
</head>
<body>
    <div class="word-template">
        <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
        <div style="text-align: center; margin-bottom: 5px;">
            <span style="font-size: 24px; font-weight: 800;">Ø·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø³ÙÙŠÙ†Ø© ØªØ¬Ø§Ø±ÙŠØ©</span>
        </div>
        <div style="text-align: center; margin-bottom: 5px;">
            <span style="font-size: 18px; font-weight: 600; color: #1e3a5f;">Enquiry for Registry Certificate of Commercial Ship</span>
        </div>
        <hr>

        <!-- Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
        <div style="margin-top: 30px;">
            <!-- 1. Ø§Ø³Ù… Ø§Ù„Ø³ÙÙŠÙ†Ø© -->
            <div class="field-row">
                <span class="field-label">Ø§Ø³Ù… Ø§Ù„Ø³ÙÙŠÙ†Ø©: (Name of the Ship)</span>
                <span class="field-value" id="shipNameEnDisplay">_________________________</span>
            </div>
            <!-- 2. Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© -->
            <div class="field-row">
                <span class="field-label">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©: (Previous Names)</span>
                <span class="field-value" id="previousNamesDisplay">_________________________</span>
            </div>
            <!-- 3. Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© IMO -->
            <div class="field-row">
                <span class="field-label">Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©: (IMO No)</span>
                <span class="field-value" id="imoNumberDisplay">_________________________</span>
            </div>
            <!-- 4. Ø¢Ø®Ø± Ù…ÙŠÙ†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ -->
            <div class="field-row">
                <span class="field-label">Ø¢Ø®Ø± Ù…ÙŠÙ†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„: (Last Port of Registry)</span>
                <span class="field-value" id="lastPortDisplay">_________________________</span>
            </div>
            <!-- 5. ØªØ§Ø±ÙŠØ® ÙˆÙ…ÙƒØ§Ù† Ø§Ù„Ø¨Ù†Ø§Ø¡ -->
            <div class="field-row">
                <span class="field-label">ØªØ§Ø±ÙŠØ® ÙˆÙ…ÙƒØ§Ù† Ø§Ù„Ø¨Ù†Ø§Ø¡: (Date and place of Construction)</span>
                <span class="field-value" id="buildDatePlaceDisplay">_________________________</span>
            </div>
            <!-- 6. Ù†ÙˆØ¹ Ø§Ù„Ø³ÙÙŠÙ†Ø© -->
            <div class="field-row">
                <span class="field-label">Ù†ÙˆØ¹ Ø§Ù„Ø³ÙÙŠÙ†Ø©: (Type of Ship)</span>
                <span class="field-value" id="shipTypeDisplay">_________________________</span>
            </div>
            <!-- 7. Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø§Ù„ÙƒÙ„ÙŠØ© -->
            <div class="field-row">
                <span class="field-label">Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø§Ù„ÙƒÙ„ÙŠØ©: (Gross Tonnage)</span>
                <span class="field-value" id="grossTonnageDisplay">_________________________</span>
            </div>
            <!-- 8. Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø³ÙÙŠÙ†Ø© -->
            <div class="field-row">
                <span class="field-label">Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø³ÙÙŠÙ†Ø© (Ø§Ù„Ø·ÙˆÙ„ØŒ Ø§Ù„Ø¹Ø±Ø¶ØŒ Ø§Ù„ØºØ§Ø·Ø³): (Ships Dimensions)</span>
                <span class="field-value" id="shipDimensionsDisplay">_________________________</span>
            </div>
            <!-- 9. Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ -->
            <div class="field-row">
                <span class="field-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ: (Owner's Name)</span>
                <span class="field-value" id="ownerNameDisplay">_________________________</span>
            </div>
            <!-- 10. Ø§Ù„Ø¬Ù†Ø³ÙŠØ© -->
            <div class="field-row">
                <span class="field-label">Ø§Ù„Ø¬Ù†Ø³ÙŠØ©: (Nationality)</span>
                <span class="field-value" id="nationalityDisplay">_________________________</span>
            </div>
            <!-- 11. Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø§Ù„Ùƒ ÙˆØªÙ„ÙÙˆÙ†Ø§ØªÙ‡ -->
            <div class="field-row">
                <span class="field-label">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø§Ù„Ùƒ ÙˆØªÙ„ÙÙˆÙ†Ø§ØªÙ‡: (Address & Tel.)</span>
                <span class="field-value" id="addressTelDisplay">_________________________</span>
            </div>
            <!-- 12. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø´ØºÙ„Ø© -->
            <div class="field-row">
                <span class="field-label">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø´ØºÙ„Ø©: (Company Name & Address)</span>
                <span class="field-value" id="companyDisplay">_________________________</span>
            </div>
            <!-- 13. Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙŠØ© Ø±Ù‡ÙˆÙ†Ø§Øª Ø£Ùˆ Ø­Ø¬ÙˆØ²Ø§Øª -->
            <div class="field-row">
                <span class="field-label">Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙŠØ© Ø±Ù‡ÙˆÙ†Ø§Øª Ø£Ùˆ Ø­Ø¬ÙˆØ²Ø§Øª: (Any mortgage Details)</span>
                <span class="field-value" id="mortgageDisplay">Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>
            </div>
        </div>

        <!-- Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± -->
        <div class="declaration-box">
            <div style="margin-bottom: 20px;">
                <span style="font-weight: 700; font-size: 16px;">Ø£Ù‚Ø± Ø£Ù†Ø§ Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø¬Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø·Ù„Ø¨ ØµØ­ÙŠØ­Ø© ÙˆØ¥Ù†Ù†ÙŠ Ø£Ø­ØªÙ…Ù„ Ø§Ù„Ù…Ø³Ø¦ÙˆÙ„ÙŠØ© Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø© ÙÙŠ Ø­Ø§Ù„Ø© ÙˆØ±ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¯Ù„ Ø¹Ù„Ù‰ ØºÙŠØ± Ø°Ù„Ùƒ.</span>
            </div>
            <div>
                <span style="font-weight: 600; font-size: 15px;">To the best of my knowledge, the information given by me on this application is true and correct in every detail. I hold all the legal responsibility of any misleading information.</span>
            </div>
        </div>

        <!-- ØªØ°ÙŠÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ -->
        <div style="display: flex; justify-content: space-between; margin-top: 35px; align-items: baseline;">
            <div style="display: flex; align-items: baseline; gap: 20px;">
                <span style="font-weight: 700;">ØªØ§Ø±ÙŠØ® ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨:</span>
                <span style="border-bottom: 1px solid black; width: 150px; display: inline-block; padding-bottom: 3px;" id="applicationDate">__________</span>
            </div>
            <div style="display: flex; align-items: baseline; gap: 20px;">
                <span style="font-weight: 700;">Ø§Ø³Ù… Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨:</span>
                <span style="border-bottom: 1px solid black; width: 180px; display: inline-block; padding-bottom: 3px;" id="applicantName">____________________</span>
            </div>
        </div>
        
        <!-- Ø®ØªÙ… ÙˆØªÙˆÙ‚ÙŠØ¹ -->
        <div style="display: flex; justify-content: flex-end; margin-top: 25px;">
            <div style="text-align: center; width: 230px;">
                <div style="border-bottom: 1px solid black; margin-bottom: 6px; padding-bottom: 5px; height: 40px;"></div>
                <span style="font-weight: 700;">Ø®ØªÙ… ÙˆØªÙˆÙ‚ÙŠØ¹ Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨</span>
            </div>
        </div>

        <!-- Ø®Ø§Ù†Ø© IMO -->
        <div style="margin-top: 35px; font-size: 12px; color: #444; text-align: left;">
            <span>IMO: <span id="imoFooter">_________</span></span>
        </div>

        <div class="footer-note">
            Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù„Ù„Ø´Ø¦ÙˆÙ† Ø§Ù„Ø¨Ø­Ø±ÙŠØ© - Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ø§Ù„ÙŠÙ…Ù†<br>
            Ù‡Ø°Ø§ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ù…Ø¹ØªÙ…Ø¯ Ø±Ø³Ù…ÙŠØ§Ù‹
        </div>
        
        <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… -->
        <div class="no-print" style="display: flex; gap: 15px; justify-content: center; margin-top: 35px;">
            <button class="btn btn-print" onclick="window.print()">
                <i>ğŸ–¨ï¸</i> Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            </button>
            <button class="btn" onclick="window.close()">
                <i>âœ–ï¸</i> Ø¥ØºÙ„Ø§Ù‚
            </button>
        </div>
    </div>

    <script>
        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
        function setText(id, value, defaultValue = '_________________________') {
            const el = document.getElementById(id);
            if (el) {
                el.textContent = (value && value !== '' && value !== null && value !== undefined) ? value : defaultValue;
            }
        }

        // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªØ§Ø±ÙŠØ®
        function formatDate(dateString) {
            if (!dateString) return '';
            try {
                const d = new Date(dateString);
                const day = d.getDate().toString().padStart(2,'0');
                const month = (d.getMonth()+1).toString().padStart(2,'0');
                const year = d.getFullYear();
                return `${day}/${month}/${year}`;
            } catch {
                return dateString;
            }
        }

        // Ø¯Ø§Ù„Ø© Ù„Ø¯Ù…Ø¬ ØªØ§Ø±ÙŠØ® ÙˆÙ…ÙƒØ§Ù† Ø§Ù„Ø¨Ù†Ø§Ø¡
        function formatBuildDatePlace(buildDate, buildPlace) {
            let result = '';
            if (buildDate) result += formatDate(buildDate);
            if (buildPlace) result += (result ? ' - ' : '') + buildPlace;
            return result || '';
        }

        // Ø¯Ø§Ù„Ø© ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
        function formatDimensions(length, width, draft) {
            let parts = [];
            if (length) parts.push(`Ø·ÙˆÙ„: ${length} Ù…`);
            if (width) parts.push(`Ø¹Ø±Ø¶: ${width} Ù…`);
            if (draft) parts.push(`ØºØ§Ø·Ø³: ${draft} Ù…`);
            return parts.join(' - ') || '';
        }

        // Ø¯Ø§Ù„Ø© Ø¹Ù†ÙˆØ§Ù† ÙˆØªÙ„ÙÙˆÙ†
        function formatAddressTel(address, phone, email) {
            let str = '';
            if (address) str += address;
            if (phone) str += (str ? ' - ' : '') + `ØªÙ„ÙÙˆÙ†: ${phone}`;
            if (email) str += (str ? ' - ' : '') + `Ø¨Ø±ÙŠØ¯: ${email}`;
            return str || '';
        }

        // Ø¯Ø§Ù„Ø© Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø´ØºÙ„Ø©
        function formatOperator(ownerType, companyName, commercialRegister) {
            if (ownerType === 'company' || ownerType === 'organization') {
                let str = companyName || '';
                if (commercialRegister) str += (str ? ' - ' : '') + `Ø³Ø¬Ù„ ØªØ¬Ø§Ø±ÙŠ: ${commercialRegister}`;
                return str || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯';
            }
            return 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ (Ù…Ø§Ù„Ùƒ ÙØ±Ø¯)';
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† sessionStorage
        function loadDataFromStorage() {
            const savedData = sessionStorage.getItem('shipRegistrationData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    
                    // Ø§Ø³Ù… Ø§Ù„Ø³ÙÙŠÙ†Ø©
                    let shipName = data.shipNameEn || data.shipName || '';
                    setText('shipNameEnDisplay', shipName);
                    
                    // Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
                    setText('previousNamesDisplay', data.previousNames || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯');
                    
                    // Ø±Ù‚Ù… IMO
                    setText('imoNumberDisplay', data.imoNumber || '');
                    setText('imoFooter', data.imoNumber || '_________');
                    
                    // Ø¢Ø®Ø± Ù…ÙŠÙ†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„
                    setText('lastPortDisplay', data.lastPort || '');
                    
                    // ØªØ§Ø±ÙŠØ® ÙˆÙ…ÙƒØ§Ù† Ø§Ù„Ø¨Ù†Ø§Ø¡
                    const buildStr = formatBuildDatePlace(data.buildDate, data.buildPlace);
                    setText('buildDatePlaceDisplay', buildStr);
                    
                    // Ù†ÙˆØ¹ Ø§Ù„Ø³ÙÙŠÙ†Ø©
                    let shipTypeText = data.shipType || '';
                    const shipTypes = {
                        'cargo': 'Ø³ÙÙŠÙ†Ø© Ø¨Ø¶Ø§Ø¦Ø¹', 'tanker': 'Ù†Ø§Ù‚Ù„Ø© Ù†ÙØ·', 'passenger': 'Ø³ÙÙŠÙ†Ø© Ø±ÙƒØ§Ø¨',
                        'fishing': 'Ø³ÙÙŠÙ†Ø© ØµÙŠØ¯', 'yacht': 'ÙŠØ®Øª', 'container': 'Ø­Ø§ÙˆÙŠØ©', 'other': 'Ø£Ø®Ø±Ù‰'
                    };
                    if (shipTypes[data.shipType]) shipTypeText = shipTypes[data.shipType];
                    setText('shipTypeDisplay', shipTypeText);
                    
                    // Ø§Ù„Ø­Ù…ÙˆÙ„Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ©
                    let gross = data.grossTonnage ? data.grossTonnage + ' Ø·Ù†' : '';
                    setText('grossTonnageDisplay', gross);
                    
                    // Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ø³ÙÙŠÙ†Ø©
                    const dims = formatDimensions(data.length, data.width, data.draft);
                    setText('shipDimensionsDisplay', dims);
                    
                    // Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ
                    let ownerName = data.fullName || '';
                    if (data.ownerType === 'company' || data.ownerType === 'organization') {
                        ownerName = data.companyName || data.fullName || '';
                    }
                    setText('ownerNameDisplay', ownerName);
                    
                    // Ø§Ù„Ø¬Ù†Ø³ÙŠØ©
                    let natText = data.nationality || '';
                    const nations = {'YE':'ÙŠÙ…Ù†ÙŠ','SA':'Ø³Ø¹ÙˆØ¯ÙŠ','AE':'Ø¥Ù…Ø§Ø±Ø§ØªÙŠ','QA':'Ù‚Ø·Ø±ÙŠ','KW':'ÙƒÙˆÙŠØªÙŠ','BH':'Ø¨Ø­Ø±ÙŠÙ†ÙŠ','OM':'Ø¹Ù…Ø§Ù†ÙŠ','other':'Ø£Ø®Ø±Ù‰'};
                    if (nations[data.nationality]) natText = nations[data.nationality];
                    setText('nationalityDisplay', natText);
                    
                    // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ø§Ù„Ùƒ ÙˆØªÙ„ÙÙˆÙ†Ø§ØªÙ‡
                    const addrTel = formatAddressTel(data.address, data.phone, data.email);
                    setText('addressTelDisplay', addrTel);
                    
                    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø´ØºÙ„Ø©
                    const operator = formatOperator(data.ownerType, data.companyName, data.commercialRegister);
                    setText('companyDisplay', operator);
                    
                    // Ø§Ù„Ø±Ù‡ÙˆÙ†Ø§Øª
                    setText('mortgageDisplay', data.mortgageDetails || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯');
                    
                    // ØªØ§Ø±ÙŠØ® ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨
                    if (data.submissionDate) {
                        setText('applicationDate', formatDate(data.submissionDate));
                    } else {
                        const today = new Date();
                        const dd = String(today.getDate()).padStart(2,'0');
                        const mm = String(today.getMonth()+1).padStart(2,'0');
                        const yyyy = today.getFullYear();
                        setText('applicationDate', `${dd}/${mm}/${yyyy}`);
                    }
                    
                    // Ø§Ø³Ù… Ù…Ù‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø¨
                    let applicantName = data.fullName || '';
                    if (data.ownerType === 'company' || data.ownerType === 'organization') {
                        applicantName = data.companyName || data.fullName || '';
                    }
                    setText('applicantName', applicantName);
                    
                } catch (e) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', e);
                    alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
                }
            } else {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª. Ø³ÙŠØªÙ… Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©.');
                window.close();
            }
        }

        // Ø·Ø¨Ø§Ø¹Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
        window.onload = function() {
            loadDataFromStorage();
            // ÙŠÙ…ÙƒÙ† ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¨Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚ Ù…Ù† Ø§Ù„Ø³Ø·Ø± Ø§Ù„ØªØ§Ù„ÙŠ
            // setTimeout(() => { window.print(); }, 500);
        };
    </script>
</body>
</html>